TODO
----

- Why is the sensitivity to th24 and th34 so different in the solar sector?

- Understand why including ATM_COMP rather than ATM_TAB changes the PG
  test by so much.

- Understand differences between my MINOS code and Michele's

- MINOS seems to have large impact on tension in 3+2, but not so much
in 3+1, see Thomas' email from Sep 23, 2011, 8:30 am.

- Try to understand good PG for app vs. disapp in the 1+3+1 case (but
not the 3+2 case)

- Study consistency of app and disapp evidence, e.g. by plotting chi^2
marginalized vs. dmsq.

- Study impact of sterile neutrinos on th23 (deviation from maximal)

- Using Thomas' code, "all except KamLAND" gives worse limit than
SBL+BUGEY_SP. Is this related to th13 fixed? Plot in th13-th14 plane
for fixed dm41?


chi^2_min results
-----------------

see worksheet sterile-nu.nb, section "Parameter goodness of fit test"


"all experiments" means:    SBL KARMEN NOMAD CDHS MB MBANTI LSND ATM_COMP MINOS_NC
"all appearance" means:     KARMEN MB MBANTI LSND
"all disappearance" means:  SBL NOMAD CDHS ATM_COMP MINOS_NC

degrees of freedom (see 1103.4570, Thomas' code, and Thomas' email from Apr 6, 2011):
  Bugey-3 spectra:         60  (25 @ 15m, 25 @ 40 m, 10 @ 90 m)
  SBL rate measurements:    9
  Chooz + Palo Verde:      15

  LSND:                    11
  MiniBooNE (anti-nu):      8 (above 475 MeV)
  MiniBooNE (nu):           8 (above 475 MeV)
  KARMEN:                   9
  NOMAD:                    1
  CDHS:                    15

  Atmospheric neutrinos:   80 (see Michele's email from Mar 29, 2011)
  MINOS_NC:                40 (20 NC, 20 CC)

  (in Thomas' analysis for 1103.4570, 1 dof is included for atmospherics)


Counting of degrees of freedom for winter 2013 simulation:
  Bugey-3 spectra:         60  --  60 bins,     1 pull
  SBL rate measurements:   16  --  19 reactors, (3 of them Bugey 3, don't double-count!), 0 pulls
  Chooz:                   14  --  14 bins,     1 pull
  Palo Verde:               1  --   1 bin,      0 pulls
  Double Chooz:            18  --  18 bins,     5 pulls
  Daya Bay:                 5  --   6 bins,    19 pulls (1 of them free)
  RENO:                     1  --   2 bins,    11 pulls (1 of them free)
  Gallium:                  4  --   4 bins,     2 pulls
  KamLAND:                 17  --  17 bins,   109 pulls
  ********* Total reactor: 136 ***********

  Atmospheric neutrinos:   80 (see Michele's email from Mar 29, 2011)
  MINOS_NC:                40 (20 NC, 20 CC), 10 pulls (5 NC, 5 CC)
  C12:                     32 (6 for LSND, 26 for KARMEN), 3 pulls
  CDHS:                    15
  solar:                  261 (162+33+42+24, see Michele's email from 2013-02-24,
                               we're using SK1_nadir rather than SK1_spect;
                               was 162 in the previous solar code, see Michele's email from 2012-10-19)
  MiniBooNE disapp nu:     15  --  16 bins, normalization adjusted to data
  MiniBooNE disapp nubar:  42 bins (21 MiniBooNE, 21 SciBooNE)
  ********* Total other disapp: 485 ***********

  LSND:                    11
  MiniBooNE app nu+nubar:  22 (11 nu_e bins per polarity, do not count nu_mu bins
                               (8 per polarity) when subtraction is done)
  KARMEN:                   9
  NOMAD:                    1
  E776:                    24 (2 * (14-2) bins,   4 pulls)
  ICARUS:                   1 bin,      0 pulls
  ********** Total appearance: 68 ************


parameter counting in my simulation:
------------------------------------
  DM41
  DM51
  TH14
  TH24
  TH15
  TH25
  TH34
  TH35
  TH23
  DM31
  TH13
  DELTA_0  |
  DELTA_1  |  only one physically relevant phase
  DELTA_2  |

parameter counting in Thomas' simulation:
-----------------------------------------

available parameters:
  Ue4
  Um4
  Ue5
  Um5
  \delta
  dm41
  dm51
(Ue3 is kept fixed at zero)

LSND+MBanti measure two mixing angles, two dm^2's, one phase
the rest measures Ue4, Um4, Ue5, Um5, dm41, dm51, one phase

Appearance measures two mixing angles, two dm^2's, one phase
Disappearance measures Ue4, Um4, Ue5, Um5, dm41, dm51



Miscellaneous Notes
-------------------

- Differences of our results compared to Giunti-Laveder:
--> see my email from 2012-06-12; for differences in the solar neutrino analysis,
  see Thomas' email from 2012-10-23 ("Re: solar limit").

- Using Thomas' code, "all except KamLAND" gives worse limit than
SBL+BUGEY_SP. Is this related to th13 fixed? Plot in th13-th14 plane
for fixed dm41?
--> It appears that some of the LBL reactor experiments have a preference
for *larger* th14. I tried setting th13 to 0, and the preferred region
for "all except KamLAND" moves to even larger th14 (by a small amount).
Plotting the allowed region in th13 vs th14 (for dm41 = 5. eV^2) does not
reveal anything unusual.

- Why is solar more constraining for th13 than for th14.
(Matter effects?)
--> Is it really more constraining? Looking at the exclusion plot in
the th13--th14 plane, it seems to me that the two limits are similar
(note that we plot sin^2 \theta_{14}, but \sin^2 2\theta_{13}!

- Why do null-app results seem to prefer, at low confidence,
non-zero theta?
--> Cannot reproduce this claim any more.

- Understand why atm depends on th34 in Thomas' 2007 paper, but not for us
--> Michele's ATM code can do *either* full matter effects (-> th34) or
include electron neutrinos, but not both.

- Quantify tensions within the appearance data
--> Done, plot is in the paper (currently fig. 7)

- What are the artifacts in the Um4-Ut4 plots at high CL?
--> Seems to be real physics, occuring when the mixing angle gets close to
    maximal. In eq. (13) of http://arxiv.org/abs/1001.0336, for alpha=s the
    leading part of the complex term is proportional to sin^2(th34) cos^2(th34) =
    1/4 * sin^2(2*th34), which is symmetric about th34=pi/4. The first term,
    on the other hand, is proportional to sin^2(th34). The sum of the two
    can thus have a bumpy feature.

- Make plot of Ue4 vs. Um4 for ATM.
--> see Dropbox/sterile-nu/plots/th24th14-atm.pdf


Important changes
-----------------

2013-03-08  Undid the second modification from 2013-02-24: ATM_MIN/MAX are
              not for the ATM analysis, but for Thomas' reactor code!
              --> Use this constraint when reactors are included!
            Require dm41, dm51 < 0.5 * (LIMIT) in 1+3+1 to avoid potential problems
              when dm45 = 2*LIMIT (which can happen in 1+3+1)

2013-03-07  Fix in the MiniBooNE code to avoid aliasing in BG oscillations
            Removed energy calibration uncertainty from MINOS code because it
              led to systematics minimization problems at very large th34

2013-03-05  Changed chi^2 function for "sys off" in MB and ICARUS to the real one
            intead of chiZero

2013-02-24  Add "Run ended at" line to end of data files
            Require dm41, dm51 to be within the ATM limits only when ATM_COMP
              code is included in the fit

2013-02-23  New solar code

2013-02-06  Discovered mistake in run-all with DELTA_0 prescan (Upper limit "0.4.7")

2013-01-31  Implemented additional low-pass filter in MINOS near detector
            to account for non-zero length of the decay pipe

2013-01-25  Include matter effects in MINOS

