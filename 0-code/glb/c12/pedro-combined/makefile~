# This Makefile assumes dynamic libraries, installed to either
# the default prefix /usr/local/ or to a user-defined directory 
# called ${prefix}.
#
# For linking against a specific version of GLoBES, libglobes.so can be 
# replaced by the respective library, such as libglobes.so.0.0.1



prefix = /usr/local
#prefixfma = /home/accioly/installedsoftware
exec_prefix = ${prefix}
#exec_prefixfma = ${prefixfma}
libdir = ${exec_prefix}/lib
#libdirfma = ${exec_prefixfma}/lib
globesconf= $(exec_prefix)/bin/globes-config
#globesconffma= $(exec_prefixfma)/bin/globes-config

#local_CFLAGS = -g -O4 
local_CFLAGS = -g -O4 -fnested-functions

INCFLAGS:=$(shell $(globesconf) --include)
#INCFLAGSfma:=$(shell $(globesconffma) --include)
#local_LDFLAGS:=$(shell $(globesconf) --libs)
local_LDFLAGS:=-L/usr/local/lib -lglobes -L/sw/lib -lgsl -lgslcblas -lm -lm
local_LTLDFLAGS:=$(shell $(globesconf) --ltlibs)
#local_LTLDFLAGSfma:=$(shell $(globesconffma) --ltlibs)

karmen: karmen.c myprob.c degfinder.c chiNPwrapper.c
	gcc -c karmen.c  myprob.c  degfinder.c chiNPwrapper.c -std=c99 -ffast-math -O3 -fnested-functions -m32
	gcc karmen.o myprob.o degfinder.o chiNPwrapper.o -o karmen  $(LDFLAGS) $(local_LDFLAGS) -std=c99 -fnested-functions -ffast-math -O3 -m32
	./karmen

lsnd: lsnd.c myprob-lsnd.c degfinder.c chiNPwrapper.c
	gcc -c lsnd.c  myprob-lsnd.c  degfinder.c chiNPwrapper.c -std=c99 -ffast-math -O3 -fnested-functions -m32
	gcc lsnd.o myprob-lsnd.o degfinder.o chiNPwrapper.o -o lsnd  $(LDFLAGS) $(local_LDFLAGS) -std=c99 -fnested-functions -ffast-math -O3 -m32
	./lsnd

lsnd-pc: lsnd.c myprob-lsnd.c degfinder.c chiNPwrapper.c
	gcc -c lsnd.c  myprob-lsnd.c  degfinder.c chiNPwrapper.c -std=c99 -ffast-math -O3  -m64
	gcc lsnd.o myprob-lsnd.o degfinder.o chiNPwrapper.o -o lsnd  $(LDFLAGS) $(local_LDFLAGS) -std=c99 -ffast-math -O3 -m64
	./lsnd

spectrum:
	globes  KARMEN-nuecarbon.glb -s --parameters="0,0,0,0,0,0" -o nue-carbon.dat

spec:
	globes  LSND-nuecarbon.glb -s --parameters="0,0,0,0,0,0" -o LSND-nue-carbon.dat


